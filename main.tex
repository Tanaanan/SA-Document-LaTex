\documentclass[a4paper,12pt]{memoir}

\usepackage{graphicx}
\usepackage{afterpage}

\XeTeXlinebreaklocale "th"
\XeTeXlinebreakskip = 0pt plus 0pt

\usepackage{fontspec}
\defaultfontfeatures{Mapping=tex-text}
\setmainfont{TeX Gyre Termes}   % Free Times
\setsansfont{TeX Gyre Heros}                % Free Helvetica
\setmonofont{TeX Gyre Cursor}               % Free Courier

\newfontfamily\thaifont
[Scale=MatchUppercase,Mapping=tex-text]{Laksaman}
\newenvironment{thailang}
{\thaifont}
{}

\usepackage[Latin,Thai]{ucharclasses}
\setTransitionTo{Thai}{\begin{thailang}}
\setTransitionFrom{Thai}{\end{thailang}}

\usepackage{polyglossia}          
\setdefaultlanguage{english}
\setotherlanguage{thai}

\DisemulatePackage{setspace}
\usepackage{setspace}
\onehalfspacing
\sloppy

\def\thaialph#1{\expandafter\thalph\csname c@#1\endcsname}
\def\thalph#1{%
    \ifcase#1\or ก\or ข\or ค\or ง\or จ\or ฉ\or ช\or ซ\or
    ฌ\or ญ\or ฎ\or ฏ\or ฐ\or ฑ\or ฒ\or ณ\or ด\or ต\or ถ\or ท\or ธ\or น\or
    บ\or ป\or ผ\or ฝ\or พ\or ฟ\or ภ\or ม\or ย\or ร\or ฤ\or ล\or ฦ\or ว\or
    ศ\or ษ\or ส\or ส\or ห\or ฬ\or อ\else ฮ\else\xpg@ill@value{#1}{thalph}\fi}

\def\thainum#1{\expandafter\thainumber\csname c@#1\endcsname}
\def\thainumber#1{%
    \thaidigits{\number#1}%
}
\def\thaidigits#1{\expandafter\thdigits #1@}
\def\thdigits#1{%
    \ifx @#1% then terminate
    \else
    \ifx0#1๐\else\ifx1#1๑\else\ifx2#1๒\else\ifx3#1๓\else\ifx4#1๔\else\ifx5#1๕\else\ifx6#1๖\else\ifx7#1๗\else\ifx8#1๘\else\ifx9#1๙\else#1\fi\fi\fi\fi\fi\fi\fi\fi\fi\fi
    \expandafter\thdigits
    \fi
}

\usepackage{graphicx}           % for includegraphics
\usepackage{url}                % for \url
\usepackage{listings}           % for psuedocode, lines of codes
\usepackage{ulem}               % for strikethrough \sout
\usepackage{multicol}           % for multicols environment
\usepackage{enumitem}           % for list labels
\usepackage[labelformat=simple]{subcaption}
\usepackage{verbatim}           % for long codes
\usepackage{natbib}             % for bibliography
\usepackage{amsmath}            % for align equation
\usepackage{amssymb}            % for math symbols
\usepackage[hidelinks]{hyperref} % Corrected link style
\setcounter{tocdepth}{2} % Add this line to show subsections in the ToC
\maxsecnumdepth{subsection} % This will enable subsection numbering
\usepackage[
type={CC},
modifier={by-nc-sa},
version={3.0},
]{doclicense}

% listings format
\lstset{
    basicstyle=\ttfamily,
    numbers=left,
    numberstyle=\small,
    xleftmargin=.1\linewidth,
    frame=single,
    captionpos=b,
    columns=fullflexible,
    breaklines=true,
    keepspaces=true,
    showstringspaces=false,
}

\begin{document}

\begin{titlingpage}
    \centering
    \includegraphics[width=4.5cm]{./Figures/logo_ku_th.png}
    
    \vspace{0.5cm}
    
    {\Large \bfseries \begin{thailang}รายงาน\end{thailang}}
    
    \vspace{0.2cm}
    
    {\Large \bfseries \begin{thailang}เรื่อง ระบบบริหารจัดการการขนส่งแก๊ส\end{thailang}}
    
    \vspace{1.5cm}
    
    \textbf{\begin{thailang}เสนอ\end{thailang}}
    
    \vspace{0.2cm}
    
    {\begin{thailang}อาจารย์สมโชค เรืองอิทธินันท์\end{thailang}}
    
    \vspace{1.5cm}
    
    {\bfseries \begin{thailang}คณะผู้จัดทำ\end{thailang}}
    
    \vspace{0.5cm}
    
    \begin{tabular}{ll}
        \begin{thailang}นาย ธนอนันท์ เฉลิมพันธ์\end{thailang} & \begin{thailang}รหัสนิสิต 6610402078\end{thailang} \\
        \begin{thailang}นาย รักษิต รุ่งรัตนไชย\end{thailang} & \begin{thailang}รหัสนิสิต 6610402205\end{thailang} \\
        \begin{thailang}นาย นรากร ธนาพรภักดี\end{thailang} & \begin{thailang}รหัสนิสิต 6610405905\end{thailang} \\
    \end{tabular}

    \vspace{1.5cm}
    
    {\begin{thailang}รายงานนี้เป็นส่วนหนึ่งของรายวิชา 01418321 การวิเคราะห์และออกแบบระบบ\end{thailang}}
    
    \vspace{0.2cm}
    
    {\begin{thailang}ภาคเรียนที่ 1 ปีการศึกษา 2568\end{thailang}}
    
    \vspace{0.2cm}
    
    {\begin{thailang}คณะวิทยาศาสตร์ ภาควิชาวิทยาการคอมพิวเตอร์\end{thailang}}
    
    \vspace{0.2cm}
    
    {\begin{thailang}มหาวิทยาลัยเกษตรศาสตร์ บางเขน\end{thailang}}
    
    \vfill
\end{titlingpage}

\frontmatter
\captionsthai

\tableofcontents
\clearpage

\listoffigures

\clearpage
\listoftables 
    
\mainmatter
% \chapter*{เกี่ยวกับเอกสาร}
% เอกสารนี้ร่างขึ้นโดยอาศัยเนื้อหาจาก \url{https://en.wikibooks.org/wiki/LaTeX}
% รหัสต้นฉบับของเอกสารนี้อยู่ที่
% \url{https://www.overleaf.com/read/cgrvbrzpxrtm} 

% ผู้ที่สนใจสามารถนำไปดัดแปลงใช้ประโยชน์ได้โดยต้องแสดงที่มา และอนุญาตให้ใช้สิทธิในแบบเดียวกัน

% \doclicenseThis

\include{chapter01-introduction}
\include{chapter02-analysis}
\include{chapter03-documentstructure}
\include{chapter04-formatting}
\include{chapter05-tablefigures}
\include{chapter06-reference}
\include{chapter07-equation}

\backmatter
\bibliographystyle{alpha}
\bibliography{MathCS}   
\end{document}